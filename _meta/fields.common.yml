- key: flowbeat
  title: flowbeat
  description:
  fields:
    - name: flow.id
      type: keyword

    - name: flow.five_tuple
      type: keyword

    - name: flow.locality
      type: keyword
      description: >
        Specifies if the flow includes any public addresses. The value will be
        either public or private.

    - name: source.locality
      type: keyword
      description: >
        Specifies if the source IP is public or private.

    - name: destination.locality
      type: keyword
      description: >
        Specifies if the destination IP is public or private.

    - name: flow.sequence_num
      type: long
      description: Sequence number of the flow report.

    - name: network.tcp.flags
      type: keyword
      description: List of TCP flags observed in the flow.

    - name: event.start
      type: date
      description: Time of first flow packet.

    - name: event.end
      type: date
      description: Time of last flow packet.

- key: ecs
  title: Elastic Common Schema
  description: Common fields from the Elastic Common Schema (ECS).
  fields:
    - name: event
      title: Event
      type: group
      description: >
        The event fields are used for context information about the data itself.
      fields:
        - name: id
          type: keyword
          description: >
            Unique ID to describe the event.
          example: 8a4f500d
          phase: 1

        - name: category
          type: keyword
          description: >
            Event category.
            This can be a user defined category.
          example: metrics

        - name: type
          type: keyword
          description: >
            A type given to this kind of event which can be used for grouping.
            This is normally defined by the user.
          example: nginx-stats-metrics

        - name: action
          type: keyword
          description: >
            The action captured by the event. The type of action will vary from
            system to system but is likely to include actions by security services,
            such as blocking or quarantining; as well as more generic actions such
            as login events, file i/o or proxy forwarding events.
            The value is normally defined by the user.
          example: reject

        - name: module
          type: keyword
          description: >
            Name of the module this data is coming from.
            This information is coming from the modules used in Beats or Logstash.
          example: mysql

        - name: dataset
          type: keyword
          description: >
            Name of the dataset.
            The concept of a `dataset` (fileset / metricset) is used in Beats as a
            subset of modules. It contains the information which is currently
            stored in metricset.name and metricset.module or fileset.name.
          example: stats

        - name: severity
          type: long
          phase: 1
          example: "7"
          description: >
            Severity describes the severity of the event. What the different
            severity values mean can very different between use cases. It's up to
            the implementer to make sure severities are consistent across events.

        - name: raw
          type: keyword
          phase: 1
          # Unfortunately this example is not shown correctly yet as | do not work
          # in tables well
          # Is &#124; is the representation of | it works except for cases where
          # used ticks.
          example: "Sep 19 08:26:10 host CEF:0&#124;Security&#124;
                threatmanager&#124;1.0&#124;100&#124;
                worm successfully stopped&#124;10&#124;src=10.0.0.1
                dst=2.1.2.2spt=1232"
          description: >
            Raw text message of entire event. Used to demonstrate log integrity.
            This field is not indexed and doc_values are disabled. It cannot be
            searched, but it can be retrieved from `_source`.
          index: false
          doc_values: false

        - name: hash
          type: keyword
          phase: 1
          example: "123456789012345678901234567890ABCD"
          description: >
            Hash (perhaps logstash fingerprint) of raw field to be able to
            demonstrate log integrity.

        - name: version
          type: keyword
          required: true
          description: >
            The version field contains the version an event for ECS adheres to.
            This field should be provided as part of each event to make it possible
            to detect to which ECS version an event belongs.
            event.version is a required field and must exist in all events. It
            describes which ECS version the event adheres to.
            The current version is 0.1.0.
          example: 0.1.0

        - name: duration
          type: long
          format: duration
          input_format: nanoseconds
          description: >
            Duration of the event in nanoseconds.

        - name: created
          type: date
          description: >
            event.created contains the date when the event was created.
            This timestamp is distinct from @timestamp in that @timestamp contains
            the processed timestamp. For logs these two timestamps can be different
            as the timestamp in the log line and when the event is read for example
            by Filebeat are not identical. `@timestamp` must contain the timestamp
            extracted from the log line, event.created when the log line is read.
            The same could apply to package capturing where @timestamp contains the
            timestamp extracted from the network package and event.created when the
            event was created.
            In case the two timestamps are identical, @timestamp should be used.

        - name: risk_score
          type: float
          description: >
            Risk score value of the event.

    - name: source
      title: Source
      type: group
      description: >
        Source fields describe details about the source of the event.
      fields:
        - name: ip
          type: ip
          description: >
            IP address of the source.

            Can be one or multiple IPv4 or IPv6 addresses.
        - name: hostname
          type: keyword
          description: >
            Hostname of the source.
        - name: port
          type: long
          phase: 1
          description: >
            Port of the source.
        - name: mac
          type: keyword
          phase: 1
          description: >
            MAC address of the source.
        - name: domain
          type: keyword
          phase: 1
          description: >
            Source domain.
        - name: subdomain
          type: keyword
          phase: 1
          description: >
            Source subdomain.
        - name: geo
          title: Geo
          type: group
          description: >
            Geo fields can carry data about a specific location related to an event
            or geo information for an IP field.
          fields:
            - name: continent_name
              type: keyword
              description: >
                Name of the continent.
            - name: country_iso_code
              type: keyword
              description: >
                Country ISO code.
            - name: location
              type: geo_point
              description: >
                Longitude and latitude.
            - name: region_name
              type: keyword
              description: >
                Region name.
            - name: city_name
              type: keyword
              description: >
                City name.
        - name: as
          type: group
          description: Autonomous System (AS) associated with the IP.
          fields:
            - name: num
              type: long
              description: >
                Autonomous system number
            - name: org
              type: keyword
              description: >
                Autonomous system organization name.

    - name: destination
      title: Destination
      type: group
      description: >
        Destination fields describe details about the destination of a
        packet/event.
      fields:
        - name: ip
          type: ip
          description: >
            IP address of the destination.
            Can be one or multiple IPv4 or IPv6 addresses.
        - name: hostname
          type: keyword
          description: >
            Hostname of the destination.
        - name: port
          type: long
          description: >
            Port of the destination.
        - name: mac
          type: keyword
          description: >
            MAC address of the destination.
        - name: domain
          type: keyword
          phase: 1
          description: >
            Destination domain.
        - name: subdomain
          type: keyword
          phase: 1
          description: >
            Destination subdomain.
        - name: geo
          title: Geo
          type: group
          description: >
            Geo fields can carry data about a specific location related to an event
            or geo information for an IP field.
          fields:
            - name: continent_name
              type: keyword
              description: >
                Name of the continent.
            - name: country_iso_code
              type: keyword
              description: >
                Country ISO code.
            - name: location
              type: geo_point
              description: >
                Longitude and latitude.
            - name: region_name
              type: keyword
              description: >
                Region name.
            - name: city_name
              type: keyword
              description: >
                City name.
        - name: as
          type: group
          description: Autonomous System (AS) associated with the IP.
          fields:
            - name: num
              type: long
              description: >
                Autonomous system number
            - name: org
              type: keyword
              description: >
                Autonomous system organization name.

    - name: device
      title: Device
      type: group
      description: >
        Device fields are used to provide additional information about the
        device that is the source of the information. This could be a firewall,
        network device, etc.
      fields:
        - name: mac
          type: keyword
          description: >
            MAC address of the device
        - name: ip
          type: ip
          description: >
            IP address of the device.
        - name: hostname
          type: keyword
          description: >
            Hostname of the device.
        - name: vendor
          type: text
          description: >
            Device vendor information.
        - name: version
          type: keyword
          description: >
            Device version.
        - name: serial_number
          type: keyword
          description: >
            Device serial number.
        - name: timezone.offset.sec
          type: long
          description: >
            Timezone offset of the host in seconds.
            Number of seconds relative to UTC. If the offset is -01:30 the
            value will be -5400.
          example: -5400
        - name: type
          type: keyword
          description: >
            The type of the device the data is coming from.
            There is no predefined list of device types. Some examples are
            `endpoint`, `firewall`, `ids`, `ips`, `proxy`.
          example: firewall

    - name: network
      title: Network
      type: group
      description: >
        Fields related to network data.
      fields:
        - name: protocol
          type: keyword
          description: >
            Network protocol name.
          example: http

        - name: direction
          type: keyword
          description: >
            Direction of the network traffic.
            Recommended values are:
              * inbound
              * outbound
              * unknown
          example: inbound

        - name: forwarded_ip
          type: ip
          description: >
            Host IP address when the source IP address is the proxy.
          example: 192.1.1.2

        # Metrics
        - name: inbound.bytes
          type: long
          format: bytes
          description: >
            Network inbound bytes.
          example: 184
        - name: inbound.packets
          type: long
          description: >
            Network inbound packets.
          example: 12
        - name: outbound.bytes
          type: long
          format: bytes
          description: >
            Network outbound bytes.
          example: 184
        - name: outbound.packets
          type: long
          description: >
            Network outbound packets.
          example: 12
        - name: total.bytes
          type: long
          format: bytes
          description: >
            Network total bytes. The sum of inbound.bytes + outbound.bytes.
          example: 368
        - name: total.packets
          type: long
          description: >
            Network outbound packets. The sum of inbound.packets + outbound.packets
          example: 24

    - name: geo
      title: Geo
      type: group
      description: >
        Geo fields can carry data about a specific location related to an event
        or geo information for an IP field.
      fields:
        - name: continent_name
          type: keyword
          description: >
            Name of the continent.
        - name: country_iso_code
          type: keyword
          description: >
            Country ISO code.
        - name: location
          type: geo_point
          description: >
            Longitude and latitude.
        - name: region_name
          type: keyword
          description: >
            Region name.
        - name: city_name
          type: keyword
          description: >
            City name.
